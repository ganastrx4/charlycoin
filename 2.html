<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Login con World ID</title>
  <script src="https://cdn.worldcoin.org/app/v1.0/sdk.js"></script>
</head>
<body>
  <h1>Inicia sesi√≥n con World ID üåç</h1>

  <div id="world-id-container"></div>

  <script>
    const client_id = "app_7686f9027d3e3c0b53d987a3caf1e111"; // tu app_id real
    const verify_url = "https://worldid-auth-fzky.onrender.com/api/verify"; // tu backend Flask en Render

    window.onload = async () => {
      try {
        // Inicializa el widget
        const worldID = window.WorldID.init({
          app_id: client_id,
          action_id: "login-test",
          signal: "demo-login",
          verification_level: "orb", // o 'device' si quieres permitir World App
          container_id: "world-id-container",
          on_success: async (proof) => {
            // Enviamos la prueba a tu backend Flask
            const res = await fetch(verify_url, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(proof),
            });
            const data = await res.json();
            alert(data.message);
          },
          on_error: (err) => {
            console.error("Error:", err);
            alert("Error al autenticar con World ID");
          },
        });

        console.log("‚úÖ IDKit cargado correctamente");
      } catch (err) {
        console.error("Fallo al inicializar World ID:", err);
      }
    };
  </script>
</body>
</html>
